<idea-plugin version="2">
    <id>lsfusion.idea.plugin</id>
    <name>lsFusion support</name>
    <version>1.0.1</version>
    <vendor email="luxsoft@adsl.by" url="http://luxsoft.by">Luxsoft</vendor>

    <description><![CDATA[
      Plugin adds editing and navigation support for lsFusion scripting files (*.lsf)
      ]]></description>

    <change-notes><![CDATA[
      <b>Version 1.0</b><br>
      <p>Initial version</p>
      <b>Version 1.0.1</b><br>
      <p>New module type support</p>
      ]]>
    </change-notes>

    <!-- please see http://confluence.jetbrains.net/display/IDEADEV/Build+Number+Ranges for description -->
    <idea-version since-build="135.690"/>

    <!-- please see http://confluence.jetbrains.net/display/IDEADEV/Plugin+Compatibility+with+IntelliJ+Platform+Products
         on how to target different products -->
    <depends>com.intellij.properties</depends>

    <application-components>
        <!-- Add your application components here -->
    </application-components>

    <project-components>
        <!-- Add your project components here -->
        <component>
            <implementation-class>com.lsfusion.lang.meta.MetaChangeDetector</implementation-class>
            <skipForDefaultProject/>
        </component>

        <component>
            <implementation-class>com.lsfusion.design.FormDesignChangeDetector</implementation-class>
            <skipForDefaultProject/>
        </component>

        <component>
            <implementation-class>com.lsfusion.lang.psi.LSFProjectComponent</implementation-class>
        </component>

    </project-components>

    <actions>
        <!-- Add your actions here -->
        <action id="MetaCode.Enable" class="com.lsfusion.actions.MetaCodeEnableAction" text="Toggle _meta"
                description="Toggle meta code mode">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift M" keymap="$default"/>
        </action>
        <action id="MetaCode.Refresh" class="com.lsfusion.actions.MetaRefreshAction" text="Refresh _meta"
                description="Refresh meta code">
            <add-to-group group-id="CodeMenu"/>
        </action>
        <action id="MetaCode.ShowFile" class="com.lsfusion.actions.MetaShowFileAction" text="Show _meta for file"
                description="Show meta code for current file">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift J" keymap="$default"/>
        </action>
        <action id="MetaCode.HideFile" class="com.lsfusion.actions.MetaHideFileAction" text="Hide _meta for file"
                description="Hide meta code for current file">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift K" keymap="$default"/>
        </action>
        <action id="MetaCode.SyncMode" class="com.lsfusion.actions.MetaSyncModeAction" text="Meta sync mode"
                description="Toggle meta code sync mode">
            <add-to-group group-id="CodeMenu"/>
        </action>
        <action id="ToggleLSFCompletion" class="com.lsfusion.actions.ToggleCompletionAction"
                text="lsFusion completion support"
                description="Toggle lsFusion completion support">
            <add-to-group group-id="CodeMenu"/>
        </action>
        <action id="Errors" class="com.lsfusion.actions.ShowErrorsAction" text="Show errors"
                description="Show all current errors in all files">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift E" keymap="$default"/>
        </action>
        <action id="TypeInfer.File" class="com.lsfusion.lang.typeinfer.FileTypeInferAction" text="Infer _types for file"
                description="Infer types for file">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift I" keymap="$default"/>
        </action>
        <action id="TypeInfer.Project" class="com.lsfusion.lang.typeinfer.ProjectTypeInferAction"
                text="Infer _types for project" description="Infer types for project">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift P" keymap="$default"/>
        </action>
        <action id="TypeInfer.Check" class="com.lsfusion.lang.typeinfer.FindNotInferredAction" text="Find not inferred"
                description="Find not inferred elements for project">
            <add-to-group group-id="CodeMenu"/>
        </action>
        <action id="InsertComposition" class="com.lsfusion.actions.InsertCompositionAction">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift B" keymap="$default"/>
        </action>
        <action id="Project.Shorten" class="com.lsfusion.actions.ProjectShortenNamesAction" text="Shorten names for project" description="Shorten names for project">
            <add-to-group group-id="CodeMenu"/>
            <keyboard-shortcut first-keystroke="control alt shift U" keymap="$default"/>
        </action>
        <action id="Project.UnqualifyRefs" class="com.lsfusion.actions.ProjectUnqualifyRefsAction" text="Unqualify refs for project" description="Unqualify refs for project">
            <add-to-group group-id="CodeMenu"/>
        </action>
        <action id="File.UnqualifyRefs" class="com.lsfusion.actions.FileUnqualifyRefsAction" text="Unqualify refs for file" description="Unqualify refs for file">
            <add-to-group group-id="CodeMenu"/>
        </action>
        <!--<action id="Project.RenameFields" class="com.lsfusion.actions.RenameJrxmlFieldsToNewFormat" text="Rename jrxml fields" description="Rename jrxml fields to new format">-->
            <!--<add-to-group group-id="CodeMenu"/>-->
        <!--</action>-->
        <action id="NewLsfFile" class="com.lsfusion.module.NewLsfFileAction">
            <add-to-group group-id="NewGroup" anchor="first"/>
        </action>
    </actions>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Add your extensions here -->
        <fileTypeFactory implementation="com.lsfusion.lang.LSFFileTypeFactory"/>
        <lang.parserDefinition language="Lsf" implementationClass="com.lsfusion.lang.LSFParserDefinition"/>

        <fileStructureGroupRuleProvider implementation="com.lsfusion.usage.LSFStatementGroupingRuleProvider"/>
        <lang.findUsagesProvider language="Lsf" implementationClass="com.lsfusion.usage.LSFFindUsagesProvider"/>
        <usageTypeProvider implementation="com.lsfusion.usage.LSFUsageTypeProvider"/>
        <usageFilteringRuleProvider implementation="com.lsfusion.usage.LSFUsageFilteringRuleProvider"/>

        <callHierarchyProvider language="Lsf"
                               implementationClass="com.lsfusion.hierarchy.usages.LSFUsageHierarchyProvider"/>
        <typeHierarchyProvider language="Lsf"
                               implementationClass="com.lsfusion.hierarchy.classes.LSFClassHierarchyProvider"/>

        <multiHostInjector implementation="com.lsfusion.references.LSFToJavaLanguageInjector" />
        <multiHostInjector implementation="com.lsfusion.references.LSFToJrxmlLanguageInjector" />
        <!--<psi.referenceContributor implementation="com.lsfusion.references.FormJavaReferenceContributor"/>-->
        <lang.syntaxHighlighterFactory key="Lsf"
                                       implementationClass="com.lsfusion.lang.highlight.LSFSyntaxHighlighterFactory"/>
        <lang.braceMatcher language="Lsf" implementationClass="com.lsfusion.lang.LSFBraceMatcher"/>
        <lang.commenter language="Lsf" implementationClass="com.lsfusion.lang.LSFCommenter"/>
        <lang.foldingBuilder language="Lsf" implementationClass="com.lsfusion.lang.folding.LSFFoldingBuilder"/>
        <annotator language="Lsf" implementationClass="com.lsfusion.lang.LSFReferenceAnnotator"/>
        <annotator language="JAVA" implementationClass="com.lsfusion.references.FromJavaReferenceAnnotator"/>
        <readWriteAccessDetector implementation="com.lsfusion.LSFReadWriteAccessDetector"/>
        <definitionsSearch implementation="com.lsfusion.ImplementationsSearch"/>
        <gotoTargetRendererProvider implementation="com.lsfusion.LSFGoToTargetRendererProvider"/>
        <structureViewBuilder factoryClass="com.lsfusion.structure.LSFInterfacesStructureViewBuilderFactory"/>

        <fileEditorProvider implementation="com.lsfusion.design.LSFDesignEditorProvider"/>
        <codeInsight.lineMarkerProvider language="Lsf"
                                        implementationClass="com.lsfusion.design.DesignPreviewLineMarkerProvider"/>

        <codeInsight.gotoSuper language="Lsf" implementationClass="com.lsfusion.actions.LSFGoToSuperHandler"/>

        <renamePsiElementProcessor implementation="com.lsfusion.refactoring.LSFRenameFullNameProcessor"/>

        <completion.contributor language="Lsf" implementationClass="com.lsfusion.completion.ASTCompletionContributor"/>

        <internalFileTemplate name="lsFusion script"/>
        <internalFileTemplate name="lsFusion settings"/>

        <moduleBuilder builderClass="com.lsfusion.module.LSFusionModuleBuilder"/>
        <library.presentationProvider implementation="com.lsfusion.module.LSFusionLibraryPresentationProvider"/>
        <configurationType implementation="com.lsfusion.module.run.LSFusionRunConfigurationType"/>

        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.MetaIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.ModuleIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.PropIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.ClassIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.ExplicitNamespaceIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.FormIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.GroupIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.TableIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.WindowIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.NavigatorElementIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.types.indexes.ComponentIndex"/>

        <stubIndex implementation="com.lsfusion.lang.psi.stubs.extend.types.indexes.ExtendFormIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.extend.types.indexes.ExtendClassIndex"/>

        <stubIndex implementation="com.lsfusion.lang.psi.stubs.extend.types.indexes.ClassExtendsClassIndex"/>

        <stubIndex implementation="com.lsfusion.lang.psi.stubs.interfaces.types.indexes.ExplicitInterfaceIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.interfaces.types.indexes.ExplicitValueIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.interfaces.types.indexes.ImplicitValueIndex"/>
        <stubIndex implementation="com.lsfusion.lang.psi.stubs.interfaces.types.indexes.ImplicitInterfaceIndex"/>

        <stubElementTypeHolder class="com.lsfusion.lang.psi.LSFTypes"/>
        <gotoClassContributor implementation="com.lsfusion.LSFClassContributor"/>
        <gotoSymbolContributor implementation="com.lsfusion.LSFSymbolContributor"/>

        <lang.elementManipulator
                forClass="com.lsfusion.lang.psi.references.LSFJavaClassStringReference"
                implementationClass="com.lsfusion.lang.psi.references.impl.LSFJavaClassStringReferenceManipulator"/>

        <checkinHandlerFactory implementation="com.lsfusion.LSFCheckInHandlerFactory"/>

        <fileDocumentSynchronizationVetoer implementation="com.lsfusion.JarDocumentSavingVetoer"/>

        <toolWindow id="lsFusion Form Design" factoryClass="com.lsfusion.design.DesignViewToolWindowFactory"
                    anchor="right" icon="AllIcons.FileTypes.UiForm"/>

        <toolWindow id="Module Dependencies" anchor="right" icon="AllIcons.Nodes.Deploy"
                    factoryClass="com.lsfusion.dependencies.ModuleDependeciesViewToolWindowFactory"/>

        <!--<xdebugger.breakpointType implementation="com.lsfusion.debug.LSFBreakpointType" />-->
        <!--<debugger.positionManagerFactory id="lsfPositionManagerFactory" implementation="com.lsfusion.debug.LSFPositionManagerFactory"/>-->

        <!-- reports related stuff -->
        <fileTypeFactory implementation="com.lsfusion.reports.JrxmlFileTypeFactory"/>
        <codeInsight.lineMarkerProvider language="Lsf" implementationClass="com.lsfusion.reports.JrxmlLinkLineMarkerProvider"/>
    </extensions>
</idea-plugin>